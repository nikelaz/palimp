import {
    Palette,
    VerticalBox,
    Button,
    StandardListView,
} from "std-widgets.slint";

export component SitesSidebar inherits Rectangle {
    in property <[StandardListViewItem]> sites;
    in-out property <int> selected-site-index: -1;
    callback add-site-clicked();
    callback site-selected(int);

    width: 240px;
    background: Palette.alternate-background;

    VerticalBox {
        padding: 15px;
        spacing: 15px;

        VerticalBox {
            padding: 0;
            spacing: 10px;

            Text {
                text: "Sites";
                font-size: 14px;
            }

            site-list := StandardListView {
                model: root.sites;
                current-item <=> root.selected-site-index;
            }
        }

        Button {
            text: "New Site";
            clicked => {
                root.add-site-clicked();
            }
        }
    }
    
    // When selection changes, emit the index
    changed selected-site-index => {
        if (selected-site-index >= 0 && selected-site-index < sites.length) {
            root.site-selected(selected-site-index);
        }
    }
}
